# 신용카드 약관 검토 AI 에이전트 (25/11/01 - 25/11/21)

## 📋 목차

- [프로젝트 소개](#-프로젝트-소개)
- [시연](#-시연)
- [주요 기능](#-주요-기능)
- [기술 스택](#-기술-스택)
- [사용 방법](#-사용-방법)
- [주요 특징](#-주요-특징)
- [주의사항](#-주의사항)

<br />

---

## 🎯 프로젝트 소개

이 프로젝트는 **신용카드 약관의 불공정성을 자동으로 검토하고 개선안을 제안하는 AI 에이전트**입니다. LangGraph를 활용한 워크플로우와 RAG 기반 검색으로, 법령 및 불공정 사례 데이터베이스를 참조하여 정확한 분석을 제공합니다.

### 핵심 가치

- **실시간 분석**: 약관 조항을 즉시 분석하여 불공정 여부, 유형, 개선안을 제공
- **일괄 처리**: PDF 약관 파일 전체를 자동으로 분리하여 불공정 의심 조항 목록 리포트
- **RAG 기반 검색**: 관련 법령 및 유사 불공정 사례를 자동으로 검색하여 참조
- **반복 개선**: HITL(Human-In-The-Loop) 방식으로 최대 3회까지 개선안 수정 가능

<br />

### 👥 Team Ensemble 팀원
*서로의 부족한 부분을 채워주는 Team Ensemble!*
| 역할 | 담당자 | 책임 |
|:---:|:---:|:---:|
| **PM** | 이지현 | 기준 관리(평가/테스트 검증), 베이스 코드 개발 |
| **데이터 리드** | 장용석 | base dataset 구축, 프롬프트 개선 |
| **코드 및 UI 개발** | 이아민 | 기능 추가 및 오류 개선, RAG 개선 |
| **도메인 검수** | 허재정 | 약관/법령 해석 검수 |
| **라벨러** | 전원 | 테스트셋 작성/라벨링/교차검수 |

<br />

---
## ▶️ 시연

- 로그인, 챗봇에 새로운 약관 입력
  
  ![금융1](https://github.com/user-attachments/assets/e74f7824-ae18-4902-8f19-01e8cbdca89f)

- 다른 개선안 생성, PDF (전체 문서 분석), 사용 가이드 보기, 데이터 구조/판단 기준 보기

  ![금융2](https://github.com/user-attachments/assets/d5d0a624-961a-43c0-b47f-2d0a9533d9e7)

<br />

---

## ✨ 주요 기능

### 1. 💬 챗봇 모드 (단일 조항 분석)

- 사용자가 입력한 약관 조항 1개를 즉시 분석
- **불공정 여부 분류**: 공정/불공정 자동 판단
- **불공정 유형 분류**: 7가지 불공정 유형 중 해당 유형 자동 분류
- **유사 사례 검색**: RAG를 통한 관련 불공정 시정 사례 제공
- **참고 법령 검색**: 관련 법령 조항 자동 검색
- **개선안 제안**: 구체적인 개선안 및 Redline 버전 제공
- **반복 개선**: 사용자 피드백을 바탕으로 최대 3회까지 수정 가능

### 2. 📄 PDF 모드 (전체 문서 분석)

- PDF 약관 파일 전체 업로드
- 조항 단위 자동 분리 (제N조 단위)
- 불공정 의심 조항 목록 리포트 생성
- 유사도 점수 및 우선순위 표시
- 전체 문서 요약 리포트 제공

### 3. 🔐 사용자 인증

- Streamlit Authenticator 기반 로그인 시스템
- 세션별 분석 기록 관리

<br />

---

## 🛠 기술 스택

### 프레임워크 & 라이브러리

- **Frontend**: Streamlit
- **AI Framework**: LangGraph, LangChain
- **LLM**: Upstage Solar Pro 2 (`solar-pro2`)
- **Embeddings**: Upstage Solar Embedding (`solar-embedding-1-large-passage`)
- **Vector DB**: ChromaDB
- **Text Processing**: pypdf, RecursiveCharacterTextSplitter
- **Data Handling**: pandas

<br />

---

## 📖 사용 방법

### 1. 로그인

처음 실행 시 사용자 인증 화면이 표시됩니다. `auth/config.yaml`에 등록된 사용자 정보로 로그인합니다.

### 2. 챗봇 모드 (단일 조항 분석)

1. 메인 화면에서 **"💬 챗봇 (단일 조항 분석)"** 모드를 선택합니다.
2. 분석하고자 하는 약관 조항을 입력합니다.
3. **"분석 요청"** 버튼을 클릭합니다.
4. AI가 불공정 여부, 유형, 유사 사례, 참고 법령, 개선안을 제공합니다.
5. (선택) 개선안이 마음에 들지 않으면 피드백을 입력하여 수정 요청할 수 있습니다 (최대 3회).

### 3. PDF 모드 (전체 문서 분석)

1. 메인 화면에서 **"📄 PDF (전체 문서 분석)"** 모드를 선택합니다.
2. PDF 파일을 업로드합니다.
3. **"분석 시작"** 버튼을 클릭합니다.
4. 조항 단위로 자동 분리되어 분석됩니다.
5. 불공정 의심 조항 목록이 리포트로 제공됩니다.

### 4. 사이드바 설정

- **유사도 임계값**: RAG 검색 시 유사도 기준을 조정할 수 있습니다 (0~100%).
- **사용 가이드 보기**: 워크플로우 및 지원 범위를 확인할 수 있습니다.
- **데이터 구조 / 판단 기준 보기**: 분석 기준 및 데이터 구조를 확인할 수 있습니다.

<br />

---

## 🔍 주요 특징

### LangGraph 기반 워크플로우

```
입력 조항
  ↓
[검증] (Rule-based)
  ↓
[공정/불공정 분류] (LLM)
  ↓
  ├─ 공정 → [RAG 검색] → [공정 리포트 생성]
  └─ 불공정 → [불공정 유형 분류] → [RAG 검색] → [개선안 생성]
  ↓
[사용자 피드백] (HITL)
  ↓
[수정 반복] (최대 3회)
```

### RAG (Retrieval-Augmented Generation)

- **법령 검색**: 약관법, 금융소비자법, 전자금융거래법 등 관련 법령 조항 검색
- **유사 사례 검색**: 공정거래위원회 불공정 시정 사례 검색
- **유사도 기반 필터링**: 설정 가능한 유사도 임계값으로 관련성 높은 결과만 표시

### HITL (Human-In-The-Loop)

- 사용자 피드백을 바탕으로 개선안을 반복적으로 수정
- 최대 4회 반복 (초안 1회 + 수정 기회 3회)
- 각 반복마다 로그 저장 (`logs/feedback_log.jsonl`)

### 안정적인 분류 시스템

- 공정/불공정 분류 시 신뢰도 기반 재시도 (최대 3회)
- 신뢰도 임계값(0.8) 이상일 때만 결과 확정
- 불공정 유형 7가지 자동 분류

<br />

---

## ⚠️ 주의사항

> **본 서비스는 법무팀의 신규 약관 작성을 지원하는 내부용 도구입니다. AI 분석은 법적 해석을 대체하지 않으며, 최종 검토·판단 책임은 법무팀 또는 관련 부서 담당자에게 있습니다.**

### 제한 사항

- AI 분석 결과는 참고용이며, 최종 법적 판단은 전문가 검토가 필요합니다.
- 분석 정확도는 입력된 약관 조항의 명확성에 따라 달라질 수 있습니다.
- 벡터 DB 구축 시 사용된 법령 데이터는 특정 시점 기준이며, 최신 법령 반영 여부를 확인해야 합니다.

### 환경 요구사항

- 인터넷 연결 필요 (Upstage API 호출)
- 충분한 메모리 (ChromaDB 및 LLM 응답 처리)

<br />

---

## 📝 라이선스

이 프로젝트는 내부 사용 목적으로 개발되었습니다.

<br />

---

<div align="center">

**Made with ❤️ using LangGraph & Streamlit**

</div>
